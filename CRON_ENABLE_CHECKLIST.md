## Чеклист для включения cron

### ✅ Текущее состояние

**Балансы синхронизированы:**
- ЛК сервиса: BTC 0.00072997, USDT 67.34436658
- ЛК OKX: BTC 0.00072996, USDT 67.34
- ✅ **Совпадают!**

**Команды настроены в `routes/console.php`:**
- ✅ `bots:run` - каждые 5 минут
- ✅ `orders:sync` - каждую минуту
- ✅ `telegram:daily-stats` - ежедневно в 09:00
- ✅ `positions:close-small` - ежедневно в 17:26
- ✅ `stats:analyze` - ежедневно в 00:00

### Проверка перед включением

**1. Проверить, что Laravel Scheduler настроен в crontab:**

```bash
# На сервере проверить crontab
crontab -l

# Должна быть строка:
* * * * * cd /var/www/trading-bot && php artisan schedule:run >> /dev/null 2>&1
```

**2. Если строки нет, добавить:**

```bash
# Открыть crontab
crontab -e

# Добавить строку:
* * * * * cd /var/www/trading-bot && php artisan schedule:run >> /dev/null 2>&1
```

**3. Проверить, что команды работают:**

```bash
# Проверить bots:run
php artisan bots:run

# Проверить orders:sync
php artisan orders:sync

# Проверить schedule:list (если доступно)
php artisan schedule:list
```

### Рекомендации

**1. Мониторинг после включения:**

```bash
# Следить за логами в реальном времени
tail -f storage/logs/laravel.log

# Или проверять выполнение команд
grep "bots:run" storage/logs/laravel.log
grep "orders:sync" storage/logs/laravel.log
```

**2. Проверка через Telegram:**

- Уведомления о запуске ботов должны приходить каждые 5 минут
- Уведомления о закрытии позиций должны приходить при срабатывании

**3. Проверка балансов:**

```bash
# Проверить баланс через команду
php artisan balance:check BTC --exchange=okx

# Сравнить с балансом в ЛК
```

### Важные моменты

**1. Режим реальной торговли:**
- Убедитесь, что `REAL_TRADING=true` в `.env` (если хотите реальную торговлю)
- Или `dry_run=false` у ботов

**2. Размер позиций:**
- Рекомендуется начать с маленьких сумм (5-10 USDT)
- Мониторить результаты первые дни

**3. Stop-Loss / Take-Profit:**
- Убедитесь, что настроены правильно
- Проверьте, что они срабатывают корректно

### План действий

1. ✅ **Проверить crontab** (должна быть строка для `schedule:run`)
2. ✅ **Проверить работу команд** (выполнить вручную)
3. ✅ **Включить cron** (если еще не включен)
4. ✅ **Мониторить первые запуски** (проверить логи и Telegram)
5. ✅ **Проверить балансы** (убедиться, что все синхронизировано)

### Вывод

✅ **Все готово для включения cron!**

- Балансы синхронизированы
- Команды настроены
- Нужно только убедиться, что Laravel Scheduler запускается через crontab

После включения cron система будет работать автоматически:
- Боты запускаются каждые 5 минут
- Ордера синхронизируются каждую минуту
- Статистика обновляется ежедневно
