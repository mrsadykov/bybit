# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ OKX API "Instrument ID doesn't exist"

## –ü—Ä–æ–±–ª–µ–º–∞

–û—à–∏–±–∫–∞: `OKX API error: Instrument ID, Instrument ID code, or Spread ID doesn't exist.`

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ñ–æ—Ä–º–∞—Ç —Å–∏–º–≤–æ–ª–∞ –¥–ª—è OKX API –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.

---

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –§–æ—Ä–º–∞—Ç —Å–∏–º–≤–æ–ª–∞ –¥–ª—è OKX

**–ü—Ä–æ–±–ª–µ–º–∞:** OKX —Ç—Ä–µ–±—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç `BTC-USDT`, –∞ –Ω–µ `BTCUSDT`

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `formatOkxSymbol()`:
- `BTCUSDT` ‚Üí `BTC-USDT` ‚úÖ
- `ETHUSDT` ‚Üí `ETH-USDT` ‚úÖ
- `SOLUSDT` ‚Üí `SOL-USDT` ‚úÖ
- `BNBUSDT` ‚Üí `BNB-USDT` ‚úÖ

### 2. –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –û—à–∏–±–∫–∏ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å–∏–º–≤–æ–ª –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏
- –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ JSON —Å –æ—à–∏–±–∫–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è STDOUT –¥–ª—è —á–∏—Å—Ç–æ–≥–æ –≤—ã–≤–æ–¥–∞ JSON

### 3. –£–ª—É—á—à–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

- –ü–∞—Ä—Å–µ—Ä –∏—â–µ—Ç –ø–µ—Ä–≤—ã–π –≤–∞–ª–∏–¥–Ω—ã–π JSON (—Ä–µ–∑—É–ª—å—Ç–∞—Ç)
- –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç JSON —Å –æ—à–∏–±–∫–∞–º–∏
- –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ —Å–∏–º–≤–æ–ª–∞

–ú–µ—Ç–æ–¥ `formatOkxSymbol()` –¥–æ–ª–∂–µ–Ω –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å:
- `BTCUSDT` ‚Üí `BTC-USDT`
- `ETHUSDT` ‚Üí `ETH-USDT`
- `SOLUSDT` ‚Üí `SOL-USDT`
- `BNBUSDT` ‚Üí `BNB-USDT`

---

## üöÄ –ó–∞–ø—É—Å–∫ –Ω–∞ –ø—Ä–æ–¥–µ

```bash
php artisan strategy:backtest-all --period=500 --exchange=okx --output=backtest_results.json
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω—ã —Å OKX API
- ‚úÖ –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä
- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω—ã
- ‚úÖ –ü–æ–∫–∞–∑–∞–Ω–∞ —Å–≤–æ–¥–∫–∞ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

---

## üîç –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –≤—Å–µ –µ—â–µ –µ—Å—Ç—å

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –§–æ—Ä–º–∞—Ç —Å–∏–º–≤–æ–ª–∞

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç:
```bash
php artisan strategy:backtest BTCUSDT --timeframe=1h --exchange=okx --period=100 --json
```

–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ "Instrument ID doesn't exist", –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç `formatOkxSymbol()`
2. –ö–∞–∫–æ–π —Å–∏–º–≤–æ–ª –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ API (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `BTC-USDT`)

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –§–æ—Ä–º–∞—Ç —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞

OKX —Ç—Ä–µ–±—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç:
- `1h` ‚Üí `1H` (–∑–∞–≥–ª–∞–≤–Ω–∞—è H)
- `5m` ‚Üí `5m`
- `1d` ‚Üí `1D` (–∑–∞–≥–ª–∞–≤–Ω–∞—è D)

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è —Ç–∞–π–º—Ñ—Ä–µ–π–º.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: –ü—É–±–ª–∏—á–Ω—ã–π API OKX

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –Ω–∞–ø—Ä—è–º—É—é:
```bash
curl "https://www.okx.com/api/v5/market/candles?instId=BTC-USDT&bar=1H&limit=100"
```

–ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∫–æ–¥–µ.
–ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø—Ä–æ–±–ª–µ–º–∞ –≤ API –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç–µ.

---

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –¥–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

```php
// –í fetchCandlesPublic() –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º
\Log::info('OKX API request', [
    'original_symbol' => $symbol,
    'okx_symbol' => $okxSymbol,
    'timeframe' => $timeframe,
    'okx_interval' => $okxInterval,
    'url' => $url,
]);
```

–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –ø–æ–Ω—è—Ç—å, –∫–∞–∫–æ–π —Å–∏–º–≤–æ–ª –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ API.

---

## ‚úÖ –ò—Ç–æ–≥

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã:**
1. ‚úÖ –§–æ—Ä–º–∞—Ç —Å–∏–º–≤–æ–ª–∞ –¥–ª—è OKX
2. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
3. ‚úÖ –£–ª—É—á—à–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞ –ø—Ä–æ–¥–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã!**
