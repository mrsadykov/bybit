# Отладка команды RecoverBybitTradesCommand

## Проблема

API возвращает успешный ответ (`retCode: 0`), но список ордеров пустой (`list: []`).

## Что важно знать о Bybit API

### Ограничения истории ордеров:

1. **Ордера за последние 7 дней:**
   - Можно запрашивать все закрытые статусы
   - Кроме: "Cancelled", "Rejected", "Deactivated"

2. **Ордера за последние 24 часа:**
   - Можно запрашивать все статусы включая "Cancelled", "Rejected", "Deactivated"

3. **Ордера старше 7 дней:**
   - Поддерживается запрос только исполненных ордеров (Filled, PartiallyFilled)
   - Отмененные ордера не возвращаются

## Решение

Команда теперь пробует:
1. **getExecutions()** - исполненные сделки (executions)
2. **getOrdersHistory()** - история ордеров (orders)

## Что проверить

1. **На сайте Bybit:**
   - Зайдите на bybit.com
   - Order History → Spot
   - Проверьте есть ли завершенные ордера для BTCUSDT
   - Проверьте дату последних ордеров

2. **Если ордера есть, но API их не возвращает:**
   - Проверьте что ордера были **исполнены** (Filled), а не отменены
   - Проверьте дату ордеров (если старше 7 дней - должны быть исполнены)
   - Проверьте что используете правильный символ (BTCUSDT, а не BTC-USDT)

## Использование

```bash
php artisan trades:recover-bybit --symbol=BTCUSDT
```

## Диагностика

Если ордера все еще не возвращаются:
1. Проверьте что API ключ имеет права **Read**
2. Попробуйте получить ордера без фильтра по символу (временно измените код)
3. Проверьте логи: `tail -f storage/logs/laravel.log`
