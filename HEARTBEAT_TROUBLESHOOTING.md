# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å telegram:heartbeat –Ω–∞ –ø—Ä–æ–¥–µ

## –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É —Å —Ñ–ª–∞–≥–æ–º `-v` (verbose):

```bash
php artisan telegram:heartbeat -v
```

–ò–ª–∏ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π:
```bash
php artisan telegram:heartbeat -vv
```

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç:
- –ó–∞–¥–∞–Ω –ª–∏ `TELEGRAM_HEALTH_CHAT_ID`
- –ó–∞–¥–∞–Ω –ª–∏ `TELEGRAM_HEALTH_BOT_TOKEN` (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–æ–∫–µ–Ω)
- –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ (—É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞)

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ –ø—Ä–æ–¥–µ:

```bash
grep TELEGRAM_HEALTH /var/www/trading-bot/.env
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å:
```env
TELEGRAM_HEALTH_BOT_TOKEN=8280381462:AAEeMOZ7aGtyz1n7MoWoJVSTobmZ1TEpn00
TELEGRAM_HEALTH_CHAT_ID=–í–ê–®_CHAT_ID
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

```bash
tail -n 50 /var/www/trading-bot/storage/logs/laravel.log | grep -i heartbeat
```

–ò–ª–∏ –≤—Å–µ –æ—à–∏–±–∫–∏ Telegram:
```bash
tail -n 100 /var/www/trading-bot/storage/logs/laravel.log | grep -i "telegram.*health"
```

---

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "TELEGRAM_HEALTH_CHAT_ID not set"

**–°–∏–º–ø—Ç–æ–º:** –ö–æ–º–∞–Ω–¥–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫, –Ω–æ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–æ–ª—É—á–∏—Ç–µ Chat ID —á–µ—Ä–µ–∑ `@userinfobot` (—Å–º. `TELEGRAM_HEARTBEAT_SETUP.md`)
2. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env` –Ω–∞ –ø—Ä–æ–¥–µ:
   ```env
   TELEGRAM_HEALTH_CHAT_ID=–í–ê–®_CHAT_ID
   ```
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É: `php artisan telegram:heartbeat -v`

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "No bot token available"

**–°–∏–º–ø—Ç–æ–º:** –û—à–∏–±–∫–∞ "No bot token available (neither TELEGRAM_HEALTH_BOT_TOKEN nor TELEGRAM_BOT_TOKEN is set)"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env` –Ω–∞ –ø—Ä–æ–¥–µ:
   ```bash
   grep TELEGRAM.*TOKEN /var/www/trading-bot/.env
   ```
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–¥–∞–Ω —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ç–æ–∫–µ–Ω:
   - `TELEGRAM_HEALTH_BOT_TOKEN` (–¥–ª—è health-–±–æ—Ç–∞)
   - –∏–ª–∏ `TELEGRAM_BOT_TOKEN` (–æ—Å–Ω–æ–≤–Ω–æ–π —Ç–æ–∫–µ–Ω, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è health-–±–æ—Ç–∞)

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: "Telegram health chat API error"

**–°–∏–º–ø—Ç–æ–º:** –í –ª–æ–≥–∞—Ö –æ—à–∏–±–∫–∞ –æ—Ç Telegram API (–Ω–∞–ø—Ä–∏–º–µ—Ä, "chat not found", "unauthorized").

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**

#### 3.1. –ù–µ–≤–µ—Ä–Ω—ã–π Chat ID

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Chat ID —á–µ—Ä–µ–∑ `@userinfobot`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ `/start` health-–±–æ—Ç—É (`@isServerAlive1996bot`)
3. –û–±–Ω–æ–≤–∏—Ç–µ `TELEGRAM_HEALTH_CHAT_ID` –≤ `.env`

#### 3.2. –ë–æ—Ç –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –≥—Ä—É–ø–ø—É)

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `@isServerAlive1996bot` –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π
3. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –≥—Ä—É–ø–ø—É, Chat ID –±—É–¥–µ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, `-1001234567890`)

#### 3.3. –ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω –±–æ—Ç–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ `.env` ‚Äî –æ–Ω –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `8280381462:`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ [@BotFather](https://t.me/BotFather) ‚Üí `/mybots` ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –±–æ—Ç–∞ ‚Üí `API Token`

---

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ö–æ–º–∞–Ω–¥–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ cron

**–°–∏–º–ø—Ç–æ–º:** Heartbeat –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ cron –Ω–∞—Å—Ç—Ä–æ–µ–Ω:
   ```bash
   crontab -l
   ```
   –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞:
   ```
   * * * * * cd /var/www/trading-bot && php artisan schedule:run >> /dev/null 2>&1
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Laravel Scheduler –≤–∏–¥–∏—Ç –∫–æ–º–∞–Ω–¥—É:
   ```bash
   php artisan schedule:list | grep heartbeat
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è schedule:
   ```bash
   tail -f /var/www/trading-bot/storage/logs/laravel.log | grep schedule
   ```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä—É—á–Ω—É—é

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
php artisan telegram:heartbeat -v
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ:**
```
Checking Telegram health heartbeat configuration...
Health Chat ID: 123456789
Health Bot Token: 8280381462...
Main Bot Token: 8507563866...
‚úÖ Heartbeat sent successfully
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ Telegram

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã –≤ —á–∞—Ç–µ —Å health-–±–æ—Ç–æ–º –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏:
```
üü¢ –°–ï–†–í–ï–† –†–ê–ë–û–¢–ê–ï–¢ (SERVER UP)

–í—Ä–µ–º—è (Time): 2026-01-27 12:00:00
```

---

## –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π

```bash
php artisan telegram:heartbeat -v && echo "‚úÖ SUCCESS" || echo "‚ùå FAILED - check logs"
```

---

## –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `.env`:
   ```bash
   cat /var/www/trading-bot/.env | grep TELEGRAM
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏:
   ```bash
   tail -n 200 /var/www/trading-bot/storage/logs/laravel.log | grep -i "telegram\|heartbeat" | tail -n 20
   ```

3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç:
   ```bash
   php artisan telegram:test
   ```
   –ï—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç, –∞ health-–±–æ—Ç –Ω–µ—Ç ‚Äî –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–∫–µ–Ω–µ –∏–ª–∏ chat_id health-–±–æ—Ç–∞.

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Telegram API —Å —Å–µ—Ä–≤–µ—Ä–∞:
   ```bash
   curl -s "https://api.telegram.org/bot8280381462:AAEeMOZ7aGtyz1n7MoWoJVSTobmZ1TEpn00/getMe"
   ```
   –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å JSON —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –±–æ—Ç–µ.
